This almost works but just needs a couple more tweaks.